<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hamster Tycoon AZ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background-color: #000;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* YUXARI Hƒ∞SS∆è */
        .header { margin-top: 15px; text-align: center; text-transform: uppercase; }
        .header h1 { margin: 0; font-size: 22px; font-weight: 800; letter-spacing: 1px; color: #f0b90b; }
        
        /* EKRANLAR (TABS) */
        .screen { display: none; width: 100%; flex-direction: column; align-items: center; height: 100%; overflow-y: auto; padding-bottom: 90px; }
        .screen.active { display: flex; }

        /* STATƒ∞STƒ∞KA */
        .stats-container { display: flex; justify-content: space-between; width: 92%; margin-bottom: 10px; margin-top: 10px; }
        .stat-box { background: #252525; border-radius: 10px; width: 32%; padding: 8px 5px; text-align: center; font-size: 10px; color: #888; }
        .stat-value { display: block; font-size: 13px; color: white; font-weight: bold; margin-top: 4px; }
        .yellow-text { color: #f0b90b; }
        .text-blue { color: #4facfe; }

        /* BALANS */
        .balance-container { text-align: center; margin-bottom: 10px; }
        .coin-icon { width: 28px; vertical-align: middle; margin-right: 5px; }
        .balance-text { font-size: 30px; font-weight: bold; vertical-align: middle; }

        /* PROGRESS BAR */
        .progress-container { width: 90%; margin-bottom: 10px; }
        .progress-labels { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px; color: #ccc; }
        .progress-bar-bg { width: 100%; height: 8px; background: #333; border-radius: 5px; overflow: hidden; }
        .progress-bar-fill { width: 0%; height: 100%; background: linear-gradient(90deg, #6fdc72, #2ecc71); transition: width 0.3s; }

        /* HAMSTER (OYUN) */
        .main-game { flex-grow: 1; display: flex; justify-content: center; align-items: center; position: relative; width: 100%; min-height: 250px; }
        .hamster-bg-glow { position: absolute; width: 260px; height: 260px; background: radial-gradient(circle, rgba(62, 88, 148, 0.6) 0%, rgba(0,0,0,0) 70%); border-radius: 50%; z-index: 1; }
        .hamster-btn { position: relative; z-index: 2; width: 230px; cursor: pointer; transition: transform 0.1s; }
        .hamster-btn:active { transform: scale(0.95); }
        .hamster-img { width: 100%; pointer-events: none; border-radius: 50%; border: 4px solid #f0b90b; box-shadow: 0 0 20px #f0b90b; }

        /* MINING CARDS */
        .mining-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 92%; margin-top: 10px; }
        .mine-card { 
            background: #252525; border-radius: 12px; padding: 10px; 
            display: flex; flex-direction: column; justify-content: space-between;
            border-bottom: 3px solid #1a1a1a;
        }
        .mine-header { display: flex; align-items: center; margin-bottom: 5px; }
        .mine-icon { font-size: 24px; margin-right: 10px; color: #f0b90b; }
        .mine-title { font-size: 13px; font-weight: bold; line-height: 1.2; }
        .mine-profit { font-size: 10px; color: #aaa; margin-bottom: 5px; }
        .mine-price-section { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #333; padding-top: 5px; }
        .mine-lvl { font-size: 10px; font-weight: bold; }
        .mine-price { font-size: 12px; font-weight: bold; display: flex; align-items: center; }
        
        /* SHOP & WITHDRAW GRIDS */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 90%; margin-top: 20px; }
        .card { background: #1c1c1e; border-radius: 15px; padding: 15px; text-align: center; border: 1px solid #333; display: flex; flex-direction: column; justify-content: space-between; }
        .card h3 { font-size: 16px; margin: 5px 0; color: #fff; }
        .card p { font-size: 13px; color: #aaa; margin-bottom: 10px; }
        .price-btn { background: #f0b90b; color: black; border: none; padding: 10px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; font-size: 14px; }
        .price-btn:active { transform: scale(0.95); }

        /* MENYU */
        .navbar { position: fixed; bottom: 0; width: 100%; background: #1c1c1e; padding: 10px 0; border-top-left-radius: 20px; border-top-right-radius: 20px; display: flex; justify-content: space-around; z-index: 50; border-top: 1px solid #333; }
        .nav-item { text-align: center; color: #666; font-size: 11px; cursor: pointer; flex: 1; }
        .nav-item.active { color: #f0b90b; }
        .nav-icon { font-size: 20px; margin-bottom: 4px; display: block; }

        /* ANIMASIYA */
        .floating-text { position: absolute; color: white; font-size: 28px; font-weight: bold; pointer-events: none; animation: floatUp 0.8s ease-out forwards; z-index: 10; text-shadow: 0 0 5px black; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-100px); opacity: 0; } }

        /* MODAL (POPUP) Dƒ∞ZAYNI */
        .input-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center;
        }
        .modal-content {
            background: #252525; padding: 20px; border-radius: 15px; width: 80%; text-align: center; border: 1px solid #f0b90b;
        }
        .modal-input {
            width: 90%; padding: 10px; margin: 15px 0; border-radius: 8px; border: none; background: #333; color: white; font-size: 14px;
        }
        .modal-btn {
            padding: 10px 20px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; margin: 5px;
        }
        .confirm-btn { background: #f0b90b; color: black; }
        .cancel-btn { background: #444; color: white; }

        /* --- YENƒ∞: CANLI Bƒ∞LDƒ∞Rƒ∞≈û (TOAST) --- */
        .live-toast {
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 200, 0, 0.2);
            border: 1px solid #00ff00;
            color: #fff;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 12px;
            font-weight: bold;
            z-index: 3000;
            display: none; /* JS il…ô a√ßƒ±lacaq */
            backdrop-filter: blur(5px);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
            white-space: nowrap;
            animation: slideDown 0.5s ease-out;
        }
        @keyframes slideDown { 0% { top: -50px; opacity: 0; } 100% { top: 15px; opacity: 1; } }

    </style>
</head>
<body>

    <div id="liveToast" class="live-toast">User 10 AZN √áƒ±xardƒ± üí∏</div>

    <div id="dataModal" class="input-modal">
        <div class="modal-content">
            <h3 id="modal-title">M…ôlumat</h3>
            <p style="font-size:12px; color:#aaa;" id="modal-desc">Z…ôhm…ôt olmasa daxil edin.</p>
            <input type="text" id="user-input" class="modal-input" placeholder="Yazƒ±n...">
            <br>
            <button class="modal-btn confirm-btn" onclick="confirmAction()">T…ôsdiql…ô</button>
            <button class="modal-btn cancel-btn" onclick="closeModal()">L…ôƒüv et</button>
        </div>
    </div>

    <div id="screen-home" class="screen active">
        <div class="header"><h1>Hamster Tycoon AZ</h1></div>

        <div class="stats-container">
            <div class="stat-box">Tƒ±k Qazancƒ± <span class="stat-value yellow-text" id="per-tap">+5</span></div>
            <div class="stat-box">S…ôviyy…ôy…ô qalƒ±b <span class="stat-value text-blue" id="next-level-req">5K</span></div>
            <div class="stat-box">Saatlƒ±q G…ôlir <span class="stat-value yellow-text" id="profit-per-hour">+0</span></div>
        </div>

        <div class="balance-container">
            <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" class="coin-icon">
            <span class="balance-text" id="score">0</span>
        </div>

        <div class="progress-container">
            <div class="progress-labels"><span id="level-name">B√ºr√ºnc</span><span id="level-num">Lvl 1</span></div>
            <div class="progress-bar-bg"><div class="progress-bar-fill" id="progress-fill"></div></div>
        </div>

        <div class="main-game">
            <div class="hamster-bg-glow"></div>
            <div class="hamster-btn" onclick="tikla(event)">
                <img src="https://www.lcx.com/wp-content/uploads/hamster-kombat-token.webp" class="hamster-img" alt="Hamster">
            </div>
        </div>
        
        <div style="width: 90%; display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: bold; font-size: 14px;">
             <div><i class="fas fa-bolt yellow-text"></i> <span id="energy">500</span>/500</div>
             <div onclick="switchScreen('mine')" style="cursor: pointer;"><i class="fas fa-rocket"></i> Boost</div>
        </div>
    </div>

    <div id="screen-mine" class="screen">
        <div class="header" style="margin-bottom: 10px;"><h1>G√úCL∆èNDƒ∞RM∆è</h1></div>
        <div class="balance-container"><span class="balance-text" id="mine-score">0</span> <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="24"></div>
        <div class="mining-grid" id="mining-grid"></div>
    </div>

    <div id="screen-tiktok" class="screen">
        <div class="header" style="margin-bottom: 20px;"><h1>Tƒ∞KTOK B∆èY∆èNM∆è</h1></div>
        <div class="balance-container"><span class="balance-text" id="tt-score">0</span> <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="24"></div>
        <div class="shop-grid">
            <div class="card"><h3>1K B…ôy…ônm…ô</h3><p>2,000 Coin</p><button class="price-btn" onclick="requestItem('tiktok', 2000, '1K B…ôy…ônm…ô')">Sƒ∞FARƒ∞≈û ET</button></div>
            <div class="card"><h3>3K B…ôy…ônm…ô</h3><p>6,000 Coin</p><button class="price-btn" onclick="requestItem('tiktok', 6000, '3K B…ôy…ônm…ô')">Sƒ∞FARƒ∞≈û ET</button></div>
            <div class="card"><h3>5K B…ôy…ônm…ô</h3><p>10,000 Coin</p><button class="price-btn" onclick="requestItem('tiktok', 10000, '5K B…ôy…ônm…ô')">Sƒ∞FARƒ∞≈û ET</button></div>
            <div class="card"><h3>8K B…ôy…ônm…ô</h3><p>16,000 Coin</p><button class="price-btn" onclick="requestItem('tiktok', 16000, '8K B…ôy…ônm…ô')">Sƒ∞FARƒ∞≈û ET</button></div>
        </div>
    </div>

    <div id="screen-withdraw" class="screen">
        <div class="header" style="margin-bottom: 20px;"><h1>PUL √áIXARI≈ûI</h1></div>
        <div class="balance-container"><span class="balance-text" id="wd-score">0</span> <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="24"></div>
        <div class="shop-grid">
            <div class="card"><h3>0.20 Q…ôpik</h3><p>10,000 Coin</p><button class="price-btn" onclick="requestItem('withdraw', 10000, '0.20 Q…ôpik')">√áIXAR</button></div>
            <div class="card"><h3>0.50 Q…ôpik</h3><p>25,000 Coin</p><button class="price-btn" onclick="requestItem('withdraw', 25000, '0.50 Q…ôpik')">√áIXAR</button></div>
            <div class="card"><h3>1.00 AZN</h3><p>50,000 Coin</p><button class="price-btn" onclick="requestItem('withdraw', 50000, '1.00 AZN')">√áIXAR</button></div>
            <div class="card"><h3>10.00 AZN</h3><p>1.5M Coin</p><button class="price-btn" onclick="requestItem('withdraw', 1500000, '10.00 AZN')">√áIXAR</button></div>
        </div>
    </div>

    <div class="navbar">
        <div class="nav-item active" onclick="switchScreen('home', this)"><i class="fas fa-home nav-icon"></i> Ana S…ôhif…ô</div>
        <div class="nav-item" onclick="switchScreen('mine', this)"><i class="fas fa-hammer nav-icon"></i> Maƒüaza</div>
        <div class="nav-item" onclick="switchScreen('tiktok', this)"><i class="fab fa-tiktok nav-icon"></i> TikTok</div>
        <div class="nav-item" onclick="switchScreen('withdraw', this)"><i class="fas fa-wallet nav-icon"></i> √áƒ±xarƒ±≈ü</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // 1. DATA LOADER
        const urlParams = new URLSearchParams(window.location.search);
        let botBalance = parseFloat(urlParams.get('balance'));
        let botLevel = parseInt(urlParams.get('level'));

        let localBalance = parseFloat(localStorage.getItem('balance')) || 0;
        let localLevel = parseInt(localStorage.getItem('level')) || 1;

        let balance = (isNaN(botBalance) || localBalance > botBalance) ? localBalance : botBalance;
        let level = (isNaN(botLevel) || localLevel > botLevel) ? localLevel : botLevel;
        
        let energy = parseInt(localStorage.getItem('energy')) || 500;
        let earnPerTap = level * 5; 
        let levelThreshold = 5000 * Math.pow(2, level - 1);
        
        let defaultUpgrades = [
            { id: 'fan', name: 'Fanat', cost: 200, profit: 40, level: 0, icon: 'fa-fan' },
            { id: 'cpu', name: 'CPU', cost: 500, profit: 100, level: 0, icon: 'fa-microchip' },
            { id: 'gpu', name: 'Video Kart', cost: 1000, profit: 250, level: 0, icon: 'fa-memory' },
            { id: 'server', name: 'Server', cost: 2500, profit: 600, level: 0, icon: 'fa-server' },
            { id: 'farm', name: 'BTC Fermasƒ±', cost: 10000, profit: 2000, level: 0, icon: 'fa-industry' },
            { id: 'oil', name: 'Neft Maqnatƒ±', cost: 50000, profit: 9000, level: 0, icon: 'fa-oil-well' }
        ];

        let upgrades = JSON.parse(localStorage.getItem('upgrades')) || defaultUpgrades;
        let profitPerHour = 0;

        const scoreEl = document.getElementById('score');
        const mineScoreEl = document.getElementById('mine-score');
        const ttScoreEl = document.getElementById('tt-score');
        const wdScoreEl = document.getElementById('wd-score');
        const energyEl = document.getElementById('energy');
        const perTapEl = document.getElementById('per-tap');
        const profitEl = document.getElementById('profit-per-hour');
        const levelNumEl = document.getElementById('level-num');
        const levelReqEl = document.getElementById('next-level-req');
        const progressFill = document.getElementById('progress-fill');
        const miningGrid = document.getElementById('mining-grid');

        // --- YENƒ∞: CANLI Bƒ∞LDƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ (Fake Notifications) ---
        const fakeNames = ["Murad", "Aysel", "Elvin", "Zeyn", "Nigar", "Samir", "Leyla", "Admin", "User777"];
        const fakeActions = ["0.50 AZN √áƒ±xardƒ± üí∏", "1K TikTok B…ôy…ônm…ô Aldƒ± üéµ", "10 AZN √áƒ±xardƒ± ü§ë", "5K Like Sifari≈ü Etdi ‚ù§Ô∏è", "0.20 AZN √áƒ±xardƒ± üí∏"];

        function showLiveNotification() {
            const toast = document.getElementById('liveToast');
            const randomName = fakeNames[Math.floor(Math.random() * fakeNames.length)];
            const randomAction = fakeActions[Math.floor(Math.random() * fakeActions.length)];
            
            toast.innerText = `${randomName} ${randomAction}`;
            toast.style.display = 'block';

            setTimeout(() => {
                toast.style.display = 'none';
            }, 4000); // 4 saniy…ô g√∂rs…ônir
        }

        // H…ôr 10-15 saniy…ôd…ôn bir bildiri≈ü √ßƒ±xarƒ±r
        setInterval(showLiveNotification, 12000); 
        // ----------------------------------------------------

        // POPUP SISTEMI
        let pendingAction = null;

        function requestItem(type, price, name) {
            if (balance < price) {
                tg.showAlert("‚ùå Balans kifay…ôt etmir!");
                return;
            }
            pendingAction = { type, price, name };
            const modal = document.getElementById('dataModal');
            const title = document.getElementById('modal-title');
            const desc = document.getElementById('modal-desc');
            const input = document.getElementById('user-input');
            
            if (type === 'withdraw') {
                title.innerText = "Pul √áƒ±xarƒ±≈üƒ±";
                desc.innerText = "Kart v…ô ya M10 n√∂mr…ônizi yazƒ±n:";
                input.placeholder = "M…ôs: 0501234567";
            } else {
                title.innerText = "TikTok Sifari≈üi";
                desc.innerText = "Video Linkini bura yapƒ±≈üdƒ±rƒ±n:";
                input.placeholder = "https://vm.tiktok.com/...";
            }
            
            input.value = "";
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('dataModal').style.display = 'none';
            pendingAction = null;
        }

        function confirmAction() {
            if (!pendingAction) return;
            const inputVal = document.getElementById('user-input').value;
            if (inputVal.trim() === "") {
                tg.showAlert("‚ö†Ô∏è M…ôlumatƒ± daxil edin!");
                return;
            }

            balance -= pendingAction.price;
            updateUI();
            
            let data = {
                action: pendingAction.type,
                amount: pendingAction.price,
                item: pendingAction.name,
                input_data: inputVal 
            };
            tg.sendData(JSON.stringify(data));
            closeModal();
        }

        function calculateProfit() {
            profitPerHour = upgrades.reduce((total, item) => total + (item.level * item.profit), 0);
        }

        function updateUI() {
            let displayBalance = Math.floor(balance);
            scoreEl.innerText = displayBalance;
            mineScoreEl.innerText = displayBalance;
            ttScoreEl.innerText = displayBalance;
            wdScoreEl.innerText = displayBalance;
            energyEl.innerText = energy;
            perTapEl.innerText = "+" + earnPerTap;
            profitEl.innerText = "+" + formatNumber(profitPerHour);
            levelNumEl.innerText = `Lvl ${level}`;
            levelReqEl.innerText = formatNumber(levelThreshold);
            let percentage = (balance / levelThreshold) * 100;
            if (percentage > 100) percentage = 100;
            progressFill.style.width = percentage + "%";
            
            localStorage.setItem('balance', balance);
            localStorage.setItem('energy', energy);
            localStorage.setItem('level', level);
            localStorage.setItem('upgrades', JSON.stringify(upgrades));
        }

        function renderUpgrades() {
            miningGrid.innerHTML = "";
            upgrades.forEach((item, index) => {
                let currentCost = Math.floor(item.cost * Math.pow(1.5, item.level));
                let card = document.createElement('div');
                card.className = 'mine-card';
                card.onclick = () => buyUpgrade(index);
                card.innerHTML = `<div class="mine-header"><i class="fas ${item.icon} mine-icon"></i><div><div class="mine-title">${item.name}</div><div class="mine-profit">+${item.profit}/s</div></div></div><div class="mine-price-section"><div class="mine-lvl">Lvl ${item.level}</div><div class="mine-price">${formatNumber(currentCost)}</div></div>`;
                miningGrid.appendChild(card);
            });
        }

        function buyUpgrade(index) {
            let item = upgrades[index];
            let cost = Math.floor(item.cost * Math.pow(1.5, item.level));
            if (balance >= cost) { balance -= cost; item.level++; calculateProfit(); updateUI(); renderUpgrades(); }
        }

        function tikla(event) {
            if (energy <= 0) return;
            energy -= 1; balance += earnPerTap;
            if (balance >= levelThreshold) { 
                level++; 
                earnPerTap = level * 5; 
                levelThreshold *= 2; 
            }
            updateUI();
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            let floatText = document.createElement("div");
            floatText.className = "floating-text";
            floatText.innerText = "+" + earnPerTap;
            let x = event.clientX; let y = event.clientY;
            floatText.style.left = x + "px"; floatText.style.top = y + "px";
            document.body.appendChild(floatText);
            setTimeout(() => floatText.remove(), 800);
        }

        function switchScreen(name, btn) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-' + name).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            if(btn) btn.classList.add('active');
            else document.querySelectorAll('.nav-item')[0].classList.add('active');
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num;
        }

        setInterval(() => { if (profitPerHour > 0) { balance += profitPerHour / 3600; updateUI(); } }, 1000);
        setInterval(() => { if (energy < 500) { energy++; updateUI(); } }, 1000);

        calculateProfit(); renderUpgrades(); updateUI();
        
        // ƒ∞lk a√ßƒ±lƒ±≈üda bir d…ôn…ô bildiri≈ü g√∂st…ôr…ôk ki, maraqlƒ± olsun
        setTimeout(showLiveNotification, 3000);
    </script>
</body>
</html>
